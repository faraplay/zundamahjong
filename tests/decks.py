from collections import Counter

from zundamahjong.mahjong.deck import four_player_deck
from zundamahjong.mahjong.tile import TileId


def fill_missing_tiles(
    deck_front: list[TileId], deck_back: list[TileId]
) -> list[TileId]:
    count_deck = Counter(four_player_deck)
    count_deck.subtract(deck_front)
    count_deck.subtract(deck_back)
    assert -count_deck == {}
    return deck_front + list(count_deck.elements()) + deck_back


test_deck1 = fill_missing_tiles(
    [10, 20, 30, 40, 11, 21, 31, 41, 110, 111, 112, 113, 120, 121, 122, 123]
    + [50, 60, 70, 80, 51, 61, 71, 81, 130, 131, 132, 133, 140, 141, 142, 143]
    + [90, 210, 211, 212, 91, 92, 93, 213, 150, 151, 152, 153, 160, 161, 162, 163]
    + [170, 171, 172, 173]
    + [12, 13, 22, 23, 32, 33, 42, 43, 52, 53, 62, 63, 72, 73],
    [82, 83],
)

test_deck2 = fill_missing_tiles(
    [10, 11, 12, 13, 20, 21, 22, 23, 110, 111, 112, 120, 30, 31, 32, 33]
    + [40, 41, 42, 43, 50, 51, 52, 53, 121, 122, 310, 311, 60, 61, 62, 63]
    + [70, 71, 72, 130, 73, 131, 132, 133, 320, 321, 322, 140, 80, 81, 82, 83]
    + [410, 420, 150, 90]
    + [91, 92, 160, 93, 210, 211, 212, 213, 220, 221, 222, 223, 230, 231, 232, 233],
    [360, 370, 430],
)

test_deck3 = fill_missing_tiles(
    [10, 11, 12, 13, 20, 21, 22, 23, 30, 31, 32, 33, 40, 41, 42, 43]
    + [50, 51, 52, 53, 60, 61, 62, 63, 70, 71, 72, 73, 80, 81, 82, 83]
    + [110, 111, 112, 113, 120, 121, 122, 123, 130, 131, 132, 133, 140, 141, 142, 143]
    + [410, 420, 90, 91]
    + [430, 190, 450, 191, 210, 211, 212, 213],
    [340, 460, 350, 360, 370, 440],
)

test_deck4 = fill_missing_tiles(
    [130, 10, 11, 12, 110, 120, 20, 21, 131, 132, 30, 31, 210, 211, 212, 213]
    + [40, 41, 42, 43, 50, 51, 52, 53, 60, 61, 62, 63, 220, 221, 222, 223]
    + [70, 71, 72, 73, 80, 81, 82, 83, 90, 91, 92, 93, 230, 231, 232, 233]
    + [310, 311, 312, 133]
    + [320, 321, 322, 323, 330, 331, 332, 333],
    [],
)

test_deck5 = fill_missing_tiles([410], [10, 420])

test_deck6 = fill_missing_tiles(
    [110, 111, 112, 113, 10, 11, 12, 13, 20, 21, 22, 23, 30, 31, 32, 33]
    + [120, 121, 122, 123, 40, 41, 42, 43, 50, 51, 52, 53, 60, 61, 62, 63]
    + [130, 131, 132, 133, 70, 71, 72, 73, 80, 81, 82, 83, 90, 91, 92, 93]
    + [310, 210, 211, 212]
    + [311],
    [],
)

test_deck_rinshan = fill_missing_tiles(
    [410, 420, 430, 440, 10, 11, 12, 13, 20, 21, 22, 23, 30, 31, 32, 33]
    + [120, 121, 122, 123, 210, 220, 230, 240, 40, 41, 42, 43, 50, 51, 52, 53]
    + [130, 131, 132, 133, 250, 260, 270, 280, 60, 61, 62, 63, 70, 71, 72, 73]
    + [140, 290, 80, 81]
    + [141, 310],
    [311, 480, 110, 111, 112, 113, 450],
)

test_deck_haitei = fill_missing_tiles(
    [10, 11, 12, 13, 110, 111, 112, 113, 20, 21, 22, 23, 30, 31, 32, 33]
    + [40, 41, 42, 43, 120, 121, 122, 123, 50, 51, 52, 53, 60, 61, 62, 63]
    + [70, 71, 72, 73, 130, 131, 132, 133, 80, 81, 82, 83, 90, 91, 92, 93]
    + [210, 310, 211, 212],
    [311, 320, 321, 330, 331, 332, 333, 410, 420, 430, 440, 450, 460, 470, 480],
)

test_deck_kan_tenhou = fill_missing_tiles(
    [110, 120, 130, 140, 210, 211, 212, 213, 10, 11, 12, 13, 20, 21, 22, 23]
    + [150, 160, 161, 162, 220, 221, 222, 223, 30, 31, 32, 33, 40, 41, 42, 43]
    + [163, 170, 180, 190, 230, 231, 232, 233, 50, 51, 52, 53, 60, 61, 62, 63]
    + [310, 320, 330, 340]
    + [311, 321],
    [131],
)

test_deck_one_discard_option = fill_missing_tiles(
    [110, 111, 112, 113, 10, 11, 12, 13, 20, 21, 22, 23, 30, 31, 32, 33]
    + [120, 121, 122, 123, 40, 41, 42, 43, 50, 51, 52, 53, 60, 61, 62, 63]
    + [130, 131, 132, 133, 70, 71, 72, 73, 80, 81, 82, 83, 90, 91, 92, 93]
    + [310, 140, 210, 211]
    + [311],
    [320, 141, 142],
)
